webpackJsonp([23],{ANLb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),n={data:function(){return{tableData:[],searchContent:"",searchType:"",filteredData:[],dialogVisible:!1,currentApplication:{},searchResults:[]}},computed:{searchPlaceholder:function(){switch(this.searchType){case"applicationId":return"请输入申请ID";case"customerId":return"请输入客户id";default:return""}}},mounted:function(){this.getApplicationInfo()},methods:{getApplicationInfo:function(){var t=this;this.$axios("/api/invoiceApplications/queryAll").then(function(e){t.tableData=e.data.map(function(t){var e=new Date(t.applicationDate),a=new Date(t.issuanceDate),i=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0"),n=a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0")+"-"+String(a.getDate()).padStart(2,"0");return l()({},t,{applicationDate:i,issuanceDate:n})}),t.filteredData=t.tableData}).catch(function(t){console.log(t)})},searchApplications:function(){var t=this;this.searchType&&this.searchContent?(this.searchResults=this.tableData.filter(function(e){return String(e[t.searchType]).includes(t.searchContent)}),0===this.searchResults.length?this.$message.error("没有找到匹配的申请."):this.dialogVisible=!0):this.$message.error("请填写搜索条件.")},openDialog:function(t){this.currentApplication=l()({},t),this.dialogVisible=!0},approveApplication:function(){var t=this;this.$axios({url:"/api/invoiceApplications/update",method:"put",data:{applicationId:this.currentApplication.applicationId,customerId:this.currentApplication.customerId,orderId:this.currentApplication.orderId,invoiceType:this.currentApplication.invoiceType,taxId:this.currentApplication.taxId,applicationDate:this.currentApplication.applicationDate,issuanceDate:this.currentApplication.issuanceDate,statusOfApplication:this.currentApplication.statusOfApplication}}).then(function(e){console.log(t.currentOrder),t.$message.success("发票申请已更新."),t.getApplicationInfo(),t.dialogVisible=!1}).catch(function(e){t.$message.error("发票申请更新出错.")})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.filteredData}},[a("el-table-column",{attrs:{prop:"applicationId",label:"申请ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"customerId",label:"客户ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"orderId",label:"订单ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"invoiceType",label:"发票类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applicationDate",label:"申请日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statusOfApplication",label:"申请状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"issuanceDate",label:"发行日期"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{on:{click:function(a){t.openDialog(e.row)}}},[t._v("审批")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,title:"审批申请"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{model:t.currentApplication}},[a("el-form-item",{attrs:{label:"申请ID"}},[a("el-input",{attrs:{disabled:""},model:{value:t.currentApplication.applicationId,callback:function(e){t.$set(t.currentApplication,"applicationId",e)},expression:"currentApplication.applicationId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户ID"}},[a("el-input",{attrs:{disabled:""},model:{value:t.currentApplication.customerId,callback:function(e){t.$set(t.currentApplication,"customerId",e)},expression:"currentApplication.customerId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"订单ID"}},[a("el-input",{attrs:{disabled:""},model:{value:t.currentApplication.orderId,callback:function(e){t.$set(t.currentApplication,"orderId",e)},expression:"currentApplication.orderId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"发票类型"}},[a("el-input",{attrs:{disabled:""},model:{value:t.currentApplication.invoiceType,callback:function(e){t.$set(t.currentApplication,"invoiceType",e)},expression:"currentApplication.invoiceType"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"申请日期"}},[a("el-date-picker",{attrs:{type:"date",disabled:""},model:{value:t.currentApplication.applicationDate,callback:function(e){t.$set(t.currentApplication,"applicationDate",e)},expression:"currentApplication.applicationDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"发行日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请选择发行日期"},model:{value:t.currentApplication.issuanceDate,callback:function(e){t.$set(t.currentApplication,"issuanceDate",e)},expression:"currentApplication.issuanceDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"申请状态"}},[a("el-select",{model:{value:t.currentApplication.statusOfApplication,callback:function(e){t.$set(t.currentApplication,"statusOfApplication",e)},expression:"currentApplication.statusOfApplication"}},[a("el-option",{attrs:{label:"同意",value:"同意"}}),t._v(" "),a("el-option",{attrs:{label:"拒绝",value:"拒绝"}}),t._v(" "),a("el-option",{attrs:{label:"待审批",value:"待审批"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.approveApplication}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,r,!1,function(t){a("B2od")},"data-v-d80112d0",null);e.default=o.exports},B2od:function(t,e){}});