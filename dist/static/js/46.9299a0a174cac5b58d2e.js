webpackJsonp([46],{"6Qk+":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:function(){return{userType:"service",newMessage:"",messages:[],chat:{}}},mounted:function(){this.getChatInfo()},methods:{sendMessage:function(){this.conditionalupdate(),this.newMessage=""},getChatInfo:function(){var e=this,t=this.$cookies.get("userInfo").id;this.$axios("/api/customerservicechat/queryBySalepersonId/"+t).then(function(t){e.chat=t.data,console.log(e.chat);var s=e.chat.chathistory.split("^^");e.messages=[],s.forEach(function(t){var s=t.split(":");if(2===s.length){var a=s[0],n=s[1];e.messages.push({user:a,content:n})}})}).then(function(e){}).catch(function(e){})},conditionalupdate:function(){var e=this;this.$axios({url:"/api/customerservicechat/update",method:"put",data:{id:this.chat.id,customerid:this.chat.customerid,salespersonid:this.chat.salespersonid,chathistory:this.chat.chathistory+this.userType+":"+this.newMessage+"^^"}}).then(function(t){e.getChatInfo()}).catch(function(e){})}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-container"},[s("div",{staticClass:"header"},[s("el-tooltip",{attrs:{content:"请选择角色",placement:"top-start"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},[s("el-option",{attrs:{label:"客服",value:"service"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"chat-window"},e._l(e.messages,function(t,a){return s("div",{key:a,staticClass:"message"},[s("div",{class:"user"===t.user?"user-message":"service-message"},[e._v("\n          "+e._s(t.content)+" "),s("small",[e._v("("+e._s("user"===t.user?"用户":"客服")+")")])])])}),0),e._v(" "),s("div",{staticClass:"message-input"},[s("el-input",{attrs:{placeholder:"请输入信息"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.sendMessage(t):null}},model:{value:e.newMessage,callback:function(t){e.newMessage=t},expression:"newMessage"}}),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.sendMessage}},[e._v("发送")])],1)])},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(e){s("jUfb")},"data-v-2cdbb7e6",null);t.default=i.exports},jUfb:function(e,t){}});