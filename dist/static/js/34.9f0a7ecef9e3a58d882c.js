webpackJsonp([34],{"N+xz":function(t,e){},rSkG:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),l=s("exGp"),r=s.n(l),n={data:function(){return{dispatchList:[],searchId:"",isAddFormVisible:!1,newDispatch:{customerName:"",installTime:null,installer:"",status:"",returnTime:null,address:""},formRules:{}}},created:function(){this.getPartsInfo()},methods:{getPartsInfo:function(){var t=this;this.$axios("/api/serviceRepair/selectAll").then(function(e){var s=e.data;t.dispatchList=s.map(function(t){return{customerName:t.customername,installer:t.installer,status:t.status,address:t.address}})}).catch(function(t){console.log(t)})},searchDispatch:function(){console.log("搜索派工列表",this.searchId),this.fetchDispatchList(this.searchId)},fetchDispatchList:function(t){var e=this;return r()(i.a.mark(function s(){var a;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,axios.get("/api/dispatches",{params:{customerId:t}});case 3:a=s.sent,e.dispatchList=a.data,s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.error(s.t0);case 10:case"end":return s.stop()}},s,e,[[0,7]])}))()},returnVisit:function(t){console.log("回访派工",t)},confirmDelete:function(t){var e=this;this.$confirm("确认删除该派工记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteDispatch(t),e.$message({type:"success",message:"删除成功!"})}).catch(function(){})},deleteDispatch:function(t){var e=this.dispatchList.indexOf(t);console.log("删除派工",t),this.dispatchList.splice(e,1)},showAddForm:function(){this.isAddFormVisible=!0},cancelAddForm:function(){this.isAddFormVisible=!1,this.newDispatch={customerId:"",installTime:null,installer:"",status:"",returnTime:null,address:""},this.$refs.addForm.resetFields()},submitAddForm:function(){var t,e=this;this.$refs.addForm.validate((t=r()(i.a.mark(function t(s){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!s){t.next=8;break}console.log("新增派工记录",e.newDispatch),e.isAddFormVisible=!1,e.newDispatch={customerId:"",installTime:null,installer:"",status:"",returnTime:null,address:""},e.$refs.addForm.resetFields(),e.$message({type:"success",message:"添加成功！"}),t.next=10;break;case 8:return console.log("表单验证失败"),t.abrupt("return",!1);case 10:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("派工列表")])]),t._v(" "),s("div",{staticClass:"search-container"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入客户ID"},model:{value:t.searchId,callback:function(e){t.searchId=e},expression:"searchId"}}),t._v(" "),s("el-button",{staticClass:"search-button",attrs:{type:"primary"},on:{click:t.searchDispatch}},[t._v("搜索")])],1),t._v(" "),s("el-scrollbar",{staticStyle:{height:"400px"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dispatchList}},[s("el-table-column",{attrs:{prop:"customerName",label:"客户姓名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"installTime",label:"安装时间"}}),t._v(" "),s("el-table-column",{attrs:{prop:"installer",label:"安装人员"}}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"处理状态"}}),t._v(" "),s("el-table-column",{attrs:{prop:"returnTime",label:"回访时间"}}),t._v(" "),s("el-table-column",{attrs:{prop:"address",label:"地址"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"operation-btns"},[s("el-button",{attrs:{type:"primary"},on:{click:function(s){t.returnVisit(e.row)}}},[t._v("回访")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(s){t.confirmDelete(e.row)}}},[t._v("删除")])],1)]}}])})],1)],1),t._v(" "),s("el-button",{staticClass:"add-button",attrs:{icon:"el-icon-plus",circle:""},on:{click:t.showAddForm}}),t._v(" "),s("el-dialog",{attrs:{title:"新增派工记录",visible:t.isAddFormVisible},on:{"update:visible":function(e){t.isAddFormVisible=e}}},[s("el-form",{ref:"addForm",attrs:{model:t.newDispatch,rules:t.formRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"客户姓名",prop:"customerName"}},[s("el-input",{model:{value:t.newDispatch.customerId,callback:function(e){t.$set(t.newDispatch,"customerId",e)},expression:"newDispatch.customerId"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"安装时间",prop:"installTime"}},[s("el-date-picker",{attrs:{type:"date"},model:{value:t.newDispatch.installTime,callback:function(e){t.$set(t.newDispatch,"installTime",e)},expression:"newDispatch.installTime"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"安装人员",prop:"installer"}},[s("el-input",{model:{value:t.newDispatch.installer,callback:function(e){t.$set(t.newDispatch,"installer",e)},expression:"newDispatch.installer"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"地址",prop:"installer"}},[s("el-input",{model:{value:t.newDispatch.installer,callback:function(e){t.$set(t.newDispatch,"installer",e)},expression:"newDispatch.installer"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.cancelAddForm}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.submitAddForm}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var o=s("VU/8")(n,c,!1,function(t){s("N+xz")},"data-v-5f9be0f1",null);e.default=o.exports}});