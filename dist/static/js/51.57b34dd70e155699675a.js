webpackJsonp([51],{"8Yfs":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("zL8q"),i("tvR6");var s={data:function(){return{selectedDiscount:"",discountOptions:[{value:"0.8",label:"八折"},{value:"0.85",label:"八五折"},{value:"0.9",label:"九折"},{value:"0.95",label:"九五折"}],activity:{Activity_id:null,Activity_name:null,Activity_type:null,Responsible_id:null,Accessory_table_id:null},activityList:[],accessorytableList:[],clienttableList:[],verificationResult:"",showTable:!1,showTable2:!1,deleteDialogVisible:!1,deleteDialogVisible2:!1,editDialogVisible:!1,deleteAccessoryData:{},deleteClientData:{},editAccessoryData:{},editAccessory:{id:null,Table_id:null,Accessory_id:null,Accessory_name:null,Accessory_type:null,Accessory_quantity:null,Accessory_amount:null,Accessory_discount:null,Accessory_car:null}}},created:function(){this.getActivityList()},mounted:function(){this.selectedDiscount=this.scope.row.Accessory_discount},methods:{getClientTableList:function(){var e=this;this.$axios("/api/marketingclienttable/selectByTableId/"+this.activity.Accessory_table_id).then(function(t){var i=t.data;e.clienttableList=i.map(function(e){return{id:e.id,clientName:e.clientName,clientType:e.clientType,clientCar:e.clientCar,clientTel:e.clientTel,cumulativeSpend:e.cumulativeSpend}})}).catch(function(e){console.log(e)})},getAccessoryTableList:function(){var e=this;this.$axios("/api/marketingaccessorytable/selectByTableId/"+this.activity.Accessory_table_id).then(function(t){var i=t.data;e.accessorytableList=i.map(function(e){return{id:e.id,Table_id:e.tableId,Accessory_id:e.accessoryId,Accessory_name:e.accessoryName,Accessory_type:e.accessoryType,Accessory_quantity:e.accessoryQuantity,Accessory_amount:e.accessoryAmount,Accessory_car:e.accessoryCar,Accessory_discount:e.accessoryDiscount}})}).catch(function(e){console.log(e)})},getActivityList:function(){var e=this;this.$axios("/api/marketingactivity/selectAll").then(function(t){var i=t.data;e.activityList=i.map(function(e){return{Activity_id:e.id,Activity_name:e.activityName,Activity_type:e.activityType,Responsible_id:e.responsibleId,Accessory_table_id:e.accessoryTableId}})}).catch(function(e){console.log(e)})},authentication:function(){this.showTable=!1,this.showTable2=!1;var e=this.activity,t=e.Activity_id,i=e.Activity_name,s=e.Activity_type,c=e.Responsible_id,l=e.Accessory_table_id;t&&i&&s&&c&&l?this.activityList.find(function(e){return e.Activity_id===t&&e.Activity_name===i&&e.Activity_type===s&&e.Responsible_id===c&&e.Accessory_table_id===l})?(this.verificationResult="验证成功","季度营销活动"===this.activity.Activity_type?(this.showTable=!0,this.getAccessoryTableList()):"年度营销活动"===this.activity.Activity_type&&(this.showTable2=!0,this.getClientTableList())):this.verificationResult="验证失败":this.verificationResult="未输入完全"},getInputClass:function(e){var t=this.verificationResult,i=this.activity;return"验证成功"===t&&i[e]||"验证失败"===t&&i[e]?"is-success":"未输入完全"===t&&!i[e]||"验证失败"===t&&!i[e]?"is-error":"未输入完全"===t&&null===i[e]?"is-focusable":""},openDeleteDialog:function(e){this.deleteAccessoryData=e,this.deleteDialogVisible=!0},openDeleteDialog2:function(e){this.deleteClientData=e,this.deleteDialogVisible2=!0},openEditDialog:function(e){this.editAccessory.id=e.id,this.editAccessory.Accessory_type=e.Accessory_type,this.editAccessory.Accessory_amount=e.Accessory_amount,this.editAccessory.Accessory_car=e.Accessory_car,this.editAccessory.Accessory_discount=Number(e.Accessory_discount),this.editAccessory.Accessory_id=e.Accessory_id,this.editAccessory.Accessory_name=e.Accessory_name,this.editAccessory.Accessory_quantity=e.Accessory_quantity,this.editDialogVisible=!0},deleteAccessory:function(){var e=this,t=this.deleteAccessoryData;this.$axios.delete("/api/marketingaccessorytable/del/"+t.id).then(function(){e.getAccessoryTableList(),e.$message.success("删除成功")}).catch(function(t){console.log(t),e.$message.error("删除失败")}).finally(function(){e.deleteDialogVisible=!1})},deleteClient:function(){var e=this,t=this.deleteClientData;this.$axios.delete("/api/marketingclienttable/del/"+t.id).then(function(){e.getClientTableList(),e.$message.success("删除成功")}).catch(function(t){console.log(t),e.$message.error("删除失败")}).finally(function(){e.deleteDialogVisible2=!1})},updateAccessory:function(){var e=this;console.log(this.editAccessory),this.$axios({url:"/api/marketingaccessorytable/update",method:"put",data:{id:this.editAccessory.id,tableId:null,accessoryId:this.editAccessory.Accessory_id,accessoryName:this.editAccessory.Accessory_name,accessoryType:this.editAccessory.Accessory_type,accessoryQuantity:this.editAccessory.Accessory_quantity,accessoryAmount:this.editAccessory.Accessory_amount,accessoryDiscount:this.editAccessory.Accessory_discount,accessoryCar:this.editAccessory.Accessory_car}}).then(function(){e.getAccessoryTableList(),e.$message.success("更新成功")}).catch(function(t){console.log(t),e.$message.error("更新失败")}).finally(function(){e.editDialogVisible=!1})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-card",{staticClass:"box-card",attrs:{id:"card1"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("修改营销活动")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.authentication}},[e._v("\n            "+e._s(e.verificationResult||"验证")+"\n          ")])],1),e._v(" "),i("el-form",{ref:"activity",attrs:{model:e.activity,"label-width":"200px"}},[i("el-form-item",{attrs:{label:"营销活动编号",prop:"Activity_id"}},[i("el-input",{class:e.getInputClass("Activity_id"),attrs:{placeholder:"请输入营销活动编号","prefix-icon":"el-icon-check"},model:{value:e.activity.Activity_id,callback:function(t){e.$set(e.activity,"Activity_id",e._n(t))},expression:"activity.Activity_id"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"营销活动名称",prop:"Activity_name"}},[i("el-input",{class:e.getInputClass("Activity_name"),attrs:{placeholder:"请输入营销活动名称","prefix-icon":"el-icon-check"},model:{value:e.activity.Activity_name,callback:function(t){e.$set(e.activity,"Activity_name",t)},expression:"activity.Activity_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"营销活动类型",prop:"Activity_type"}},[i("el-select",{class:e.getInputClass("Activity_type"),attrs:{placeholder:"请选择营销活动类型","prefix-icon":"el-icon-check"},model:{value:e.activity.Activity_type,callback:function(t){e.$set(e.activity,"Activity_type",t)},expression:"activity.Activity_type"}},[i("el-option",{attrs:{label:"季度营销活动",value:"季度营销活动"}}),e._v(" "),i("el-option",{attrs:{label:"年度营销活动",value:"年度营销活动"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"负责人编号",prop:"Responsible_id"}},[i("el-input",{class:e.getInputClass("Responsible_id"),attrs:{placeholder:"请输入负责人编号","prefix-icon":"el-icon-check"},model:{value:e.activity.Responsible_id,callback:function(t){e.$set(e.activity,"Responsible_id",e._n(t))},expression:"activity.Responsible_id"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"对应配件表编号",prop:"Accessory_table_id"}},[i("el-input",{class:e.getInputClass("Accessory_table_id"),attrs:{placeholder:"对应配件表编号","prefix-icon":"el-icon-check"},model:{value:e.activity.Accessory_table_id,callback:function(t){e.$set(e.activity,"Accessory_table_id",e._n(t))},expression:"activity.Accessory_table_id"}})],1)],1),e._v(" "),"验证成功"===e.verificationResult?i("div",[i("el-table",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}],staticStyle:{width:"100%"},attrs:{data:e.accessorytableList}},[i("el-table-column",{attrs:{prop:"id",label:"编号"}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_id",label:"配件编号",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_name",label:"配件名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_type",label:"配件类型"}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_quantity",label:"配件数量",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_amount",label:"配件金额",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_car",label:"适配车型"}}),e._v(" "),i("el-table-column",{attrs:{prop:"Accessory_discount",label:"配件折扣",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{attrs:{placeholder:"选择折扣"},on:{change:function(i){e.updateAccessoryDiscount(t.row)}},model:{value:t.row.Accessory_discount,callback:function(i){e.$set(t.row,"Accessory_discount",i)},expression:"scope.row.Accessory_discount"}},e._l(e.discountOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){e.openEditDialog(t.row)}}},[e._v("修改")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:function(i){e.openDeleteDialog(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("el-table",{directives:[{name:"show",rawName:"v-show",value:e.showTable2,expression:"showTable2"}],staticStyle:{width:"100%"},attrs:{data:e.clienttableList}},[i("el-table-column",{attrs:{prop:"id",label:"编号"}}),e._v(" "),i("el-table-column",{attrs:{prop:"clientName",label:"客户名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"clientType",label:"客户常购买配件类型"}}),e._v(" "),i("el-table-column",{attrs:{prop:"clientCar",label:"客户常购买配件车型"}}),e._v(" "),i("el-table-column",{attrs:{prop:"clientTel",label:"客户电话"}}),e._v(" "),i("el-table-column",{attrs:{prop:"cumulativeSpend",label:"客户最近花费",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){e.openDeleteDialog2(t.row)}}},[e._v("删除")])]}}])})],1)],1):e._e(),e._v(" "),i("el-dialog",{attrs:{title:"删除配件",visible:e.deleteDialogVisible,width:"30%"},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[i("span",[e._v("确定要删除该配件吗？")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.deleteAccessory}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:function(t){e.deleteDialogVisible=!1}}},[e._v("取消")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"删除客户",visible:e.deleteDialogVisible2,width:"30%"},on:{"update:visible":function(t){e.deleteDialogVisible2=t}}},[i("span",[e._v("确定要删除该客户吗？")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.deleteClient}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:function(t){e.deleteDialogVisible2=!1}}},[e._v("取消")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"修改配件折扣",visible:e.editDialogVisible,width:"30%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[i("el-form",{ref:"editForm",attrs:{model:e.editAccessory,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"配件折扣",prop:"Accessory_discount"}},[i("span",[e._v("将其折扣修改为："+e._s(e.editAccessory.Accessory_discount))])])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.updateAccessory}},[e._v("保存")]),e._v(" "),i("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var l=i("VU/8")(s,c,!1,function(e){i("Sz8+")},null,null);t.default=l.exports},"Sz8+":function(e,t){}});