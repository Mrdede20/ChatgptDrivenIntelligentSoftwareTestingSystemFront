webpackJsonp([49],{"5ou7":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("d7EF"),l=a.n(r),s=a("mvHQ"),o=a.n(s),n=a("Dd8w"),i=a.n(n),c={data:function(){return{rawData:[{}],dialogVisible:!1,dialogData:[],currentOrder:{},searchType:"",searchContent:"",searchDialogVisible:!1,searchResults:[]}},computed:{searchPlaceholder:function(){return"orderDate"===this.searchType?"请输入日期（例如：2023-06-26）":"price"===this.searchType?"请输入价格范围（例如：100-200）":""}},mounted:function(){this.getSalesInfo()},methods:{getSalesInfo:function(){var e=this,t=this.$cookies.get("userInfo").id;this.$axios("/api/salesOrders/queryAllByCid/"+t).then(function(t){e.rawData=t.data.map(function(e){var t=new Date(e.orderDate),a=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");return i()({},e,{orderDate:a})}),console.log(e.rawData)}).catch(function(e){console.log(e)})},showDetails:function(e){this.currentOrder=e;var t=e.productId.split("^"),a=e.quantity.split("^");this.dialogData=t.map(function(e,t){return{productId:e,quantity:a[t]}}),this.dialogVisible=!0},returnGoods:function(e){this.$router.push({path:"/ReturnAndExchangeProcessing",query:{saleOrderData:o()(e)}})},refund:function(e){this.$router.push({path:"/RequestRefund",query:{saleOrderData:o()(e)}})},invoice:function(e){this.$router.push({path:"/RequestInvoicesAndReceipts",query:{saleOrderData:o()(e)}})},conditionaldelete:function(e){var t=this;this.$axios.delete("/api/salesOrders/delete/"+e.orderId).then(function(e){console.log(e.data),t.$message.success("该订单已删除."),t.getSalesInfo()}).catch(function(e){t.$message.error("删除失败.")})},searchParts:function(){if("price"===this.searchType){var e=this.searchContent.split("-").map(Number),t=l()(e,2),a=t[0],r=t[1];this.searchResults=this.rawData.filter(function(e){return e.totalPrice>=a&&e.totalPrice<=r})}else if("orderDate"===this.searchType){var s=this.searchContent;this.searchResults=this.rawData.filter(function(e){return e.orderDate===s})}this.searchDialogVisible=!0}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"top_class",staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"10px"}},[a("div",{staticClass:"searchClass",staticStyle:{display:"flex","align-items":"center"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[a("el-option",{attrs:{label:"订单日期",value:"orderDate"}}),e._v(" "),a("el-option",{attrs:{label:"总价范围",value:"price"}})],1),e._v(" "),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:e.searchPlaceholder},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchParts},slot:"append"})],1)],1)]),e._v(" "),a("hr"),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rawData}},[a("el-table-column",{attrs:{prop:"orderId",label:"销售订单ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customerId",label:"客户ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"salespersonId",label:"销售员ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderDate",label:"订单日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalPrice",label:"总价"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){e.showDetails(t.row)}}},[e._v("详细")]),e._v(" "),a("el-button",{on:{click:function(a){e.returnGoods(t.row)}}},[e._v("退换货")]),e._v(" "),a("el-button",{on:{click:function(a){e.refund(t.row)}}},[e._v("退款")]),e._v(" "),a("el-button",{on:{click:function(a){e.invoice(t.row)}}},[e._v("发票")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.conditionaldelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,title:"详细信息"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("h3",[e._v("订单ID: "+e._s(e.currentOrder.orderId))]),e._v(" "),a("h3",[e._v("客户ID: "+e._s(e.currentOrder.customerId))]),e._v(" "),a("h3",[e._v("销售员ID: "+e._s(e.currentOrder.salespersonId))]),e._v(" "),a("h3",[e._v("订单日期: "+e._s(e.currentOrder.orderDate))]),e._v(" "),a("h3",[e._v("总价: "+e._s(e.currentOrder.totalPrice))]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dialogData}},[a("el-table-column",{attrs:{prop:"productId",label:"商品ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"quantity",label:"商品数量"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.searchDialogVisible,title:"搜索结果"},on:{"update:visible":function(t){e.searchDialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchResults}},[a("el-table-column",{attrs:{prop:"orderId",label:"销售订单ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customerId",label:"客户ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"salespersonId",label:"销售员ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderDate",label:"订单日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalPrice",label:"总价"}})],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(e){a("9K7W")},"data-v-26c440df",null);t.default=d.exports},"9K7W":function(e,t){}});